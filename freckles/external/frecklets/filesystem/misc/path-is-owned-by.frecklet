doc:
  short_help: Makes sure a file/folder has a certain owner/group.
  help: |
    Makes sure a file/folder has a certain owner/group.

    This will recursively apply the owner/group change in case the path is a directory.
    If the path does not exist, an empty file will be created.

    Root/sudo permissions will be used to do the chown.

    If the owner/group does not exist on the machine, this will create them before changing the target ownership.
    
args:
  path:
    doc:
      short_help: the path in question
    type: string
    required: false
  owner:
    doc:
      short_help: the owner of the file/folder
    type: string
    required: false
    cli:
      metavar: USER
  group:
    doc:
      short_help: the group of the file/folder
    type: string
    required: false
    cli:
      metavar: GROUP
  system_user:
    doc:
      short_help: Whether the user and group should be of system user/group type.
    type: boolean
    required: false
    cli:
      show_default: true
      is_flag: true

meta:
  tags:
    - filesystem
    - file
    - chown
    - featured-frecklecutable

frecklets:
  - group-exists:
      group: "{{:: group ::}}"
      system_group: "{{:: system_user | default(omit) ::}}"
      frecklet.__skip__: "{{:: group | true_if_empty ::}}"
  - user-exists:
      name: "{{:: owner ::}}"
      system_user: "{{:: system_user | default(omit) ::}}"
      frecklet.__skip__: "{{:: owner | true_if_empty ::}}"
  - path-is-owned-by-impl:
      path: "{{:: path ::}}"
      owner: "{{:: owner | default(omit) ::}}"
      group: "{{:: group | default(omit) ::}}"
