---
doc:
  short_help: "Merges a target folder with another."
  help: |
    TBD
  further_reading:
    - "[freckfrackery.intermingle Ansible role]()"
args:
  src:
    doc:
      short_help: "The source folder."
    type: string
    required: false
    cli:
      metavar: PATH
  dest:
    doc:
      short_help: "The (intermediate) destination on the host."
    type: string
    required: true
    cli:
      metavar: PATH
  target:
    doc:
      short_help: "The target folder that gets intermingled."
    type: string
    required: false
    cli:
      metavar: PATH
  checkout_stage:
    doc:
      short_help: "Whether to perform the checkout phase."
    type: boolean
    required: false
    default: false
  checkout_type:
    doc:
      short_help: "The checkout type."
    type: string
    required: false
    default: auto
    allowed:
      - auto
      - copy
      - rsync
      - git
      - unarchive
    cli:
      metavar: TYPE
      show_default: true
  checkout_force:
    doc:
      short_help: "Whether to force-overwrite files on the checkout phase."
    type: boolean
    required: false
    default: false
  checkout_fail_if_exists:
    doc:
      short_help: "Whether to fail if the destination folder exists."
    type: boolean
    required: false
    default: false
  fail_if_target_exists:
    doc:
      short_help: "Whether to fail if the target folder exists."
    type: boolean
    required: false
    default: false
  become:
    doc:
      short_help: "Whether to use elevated privileges to intermingle."
    type: boolean
    default: false
    required: false
  intermingle_stage:
    doc:
      short_help: "Whether to perform the intermingle phase."
    type: boolean
    required: false
    default: false
  intermingle_type:
    doc:
      short_help: "The intermingle type."
    type: string
    required: false
    default: copy
    allowed:
      - symlink
      - copy
      - rsync
      - stow
      - bind-mount
    cli:
      metavar: TYPE
      show_default: true
  intermingle_config:
    doc:
      short_help: "The intermingle config."
    type: dict
    schema:
      interminglings:
        type: dict
        keyschema:
          type: string
        valueschema:
          type: string
      required: true
      cli:
        enabled: false

frecklets:
  - folder-is-intermingled-impl:
      src: "{{:: src | default(omit) ::}}"
      dest: "{{:: dest ::}}"
      checkout_type: "{{:: checkout_type | default(omit) ::}}"
      target: "{{:: target | default(omit) ::}}"
      checkout_stage: "{{:: checkout_stage ::}}"
      checkout_force: "{{:: checkout_force ::}}"
      checkout_fail_if_exists: "{{:: checkout_fail_if_exists ::}}"
      fail_if_target_exists: "{{:: fail_if_target_exists ::}}"
      intermingle_become: "{{:: intermingle_become ::}}"
      intermingle_stage: "{{:: intermingle_stage ::}}"
      intermingle_type: "{{:: intermingle_type | default(omit) ::}}"
      intermingle_config: "{{:: intermingle_config ::}}"
